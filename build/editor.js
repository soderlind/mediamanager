(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.element,n=window.wp.i18n,r=window.wp.apiFetch;var a=e.n(r);const l=window.ReactJSXRuntime;function s({folder:e,selectedId:r,onSelect:a,level:o=0}){const[d,i]=(0,t.useState)(!1),c=e.children&&e.children.length>0,m=r===e.id;return(0,l.jsxs)("li",{className:"mm-folder-item",children:[(0,l.jsxs)("button",{type:"button",className:"mm-folder-button "+(m?"is-selected":""),style:{paddingLeft:16*o+8+"px"},onClick:()=>a(e.id),"aria-current":m?"true":void 0,children:[c&&(0,l.jsx)("span",{className:"mm-folder-toggle",onClick:e=>{e.stopPropagation(),i(!d)},"aria-label":d?(0,n.__)("Collapse","mediamanager"):(0,n.__)("Expand","mediamanager"),children:(0,l.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:d?(0,l.jsx)("polyline",{points:"6 9 12 15 18 9"}):(0,l.jsx)("polyline",{points:"9 6 15 12 9 18"})})}),(0,l.jsx)("span",{className:"mm-folder-name",children:e.name}),"number"==typeof e.count&&(0,l.jsxs)("span",{className:"mm-folder-count",children:["(",e.count,")"]})]}),c&&d&&(0,l.jsx)("ul",{className:"mm-folder-children",children:e.children.map(e=>(0,l.jsx)(s,{folder:e,selectedId:r,onSelect:a,level:o+1},e.id))})]})}function o({onFolderSelect:e}){const[r,o]=(0,t.useState)([]),[d,i]=(0,t.useState)(null),[c,m]=(0,t.useState)(!0),[u,p]=(0,t.useState)(0),h=(0,t.useCallback)(async()=>{try{const e=await a()({path:"/wp/v2/media-folders?per_page=100&hierarchical=1"}),t=function(e){const t={},n=[];return e.forEach(e=>{t[e.id]={...e,children:[]}}),e.forEach(e=>{e.parent&&t[e.parent]?t[e.parent].children.push(t[e.id]):n.push(t[e.id])}),n}(e);o(t);const n=await a()({path:"/wp/v2/media?per_page=1",parse:!1}),r=parseInt(n.headers.get("X-WP-Total"),10)||0;let l=0;e.forEach(e=>{l+=e.count||0}),p(Math.max(0,r-l))}catch(e){console.error("Error fetching folders:",e)}finally{m(!1)}},[]);function f(t){i(t),e?.(t)}return(0,t.useEffect)(()=>{h()},[h]),c?(0,l.jsx)("div",{className:"mm-folder-sidebar mm-folder-sidebar--loading",children:(0,l.jsx)("p",{children:(0,n.__)("Loadingâ€¦","mediamanager")})}):(0,l.jsx)("div",{className:"mm-folder-sidebar",children:(0,l.jsxs)("ul",{className:"mm-folder-list",children:[(0,l.jsx)("li",{className:"mm-folder-item",children:(0,l.jsx)("button",{type:"button",className:"mm-folder-button "+(null===d?"is-selected":""),onClick:()=>f(null),"aria-current":null===d?"true":void 0,children:(0,l.jsx)("span",{className:"mm-folder-name",children:(0,n.__)("All Media","mediamanager")})})}),(0,l.jsx)("li",{className:"mm-folder-item",children:(0,l.jsxs)("button",{type:"button",className:"mm-folder-button "+("uncategorized"===d?"is-selected":""),onClick:()=>f("uncategorized"),"aria-current":"uncategorized"===d?"true":void 0,children:[(0,l.jsx)("span",{className:"mm-folder-name",children:(0,n.__)("Uncategorized","mediamanager")}),(0,l.jsxs)("span",{className:"mm-folder-count",children:["(",u,")"]})]})}),r.map(e=>(0,l.jsx)(s,{folder:e,selectedId:d,onSelect:f},e.id))]})})}function d(){if(!window.wp?.media?.view?.AttachmentsBrowser)return void setTimeout(d,100);const e=wp.media.view.AttachmentsBrowser.prototype.render;wp.media.view.AttachmentsBrowser.prototype.render=function(){if(e.apply(this,arguments),!this.$el.find(".mm-editor-folder-sidebar").length){const e=this.$el.find(".attachments-wrapper").first(),n=this.$el.find(".attachments").first();if(e.length||n.length){const r=document.createElement("div");r.className="mm-editor-folder-sidebar",e.length?e.prepend(r):n.before(r);const a=this.collection,l=this;(0,t.createRoot)(r).render((0,t.createElement)(o,{onFolderSelect:e=>{if(!a)return;const t=l.$el.find(".attachments");t.addClass("mm-loading"),null!==e?l.$el.addClass("mm-folder-filtered"):l.$el.removeClass("mm-folder-filtered"),a.props.unset("media_folder"),a.props.unset("media_folder_exclude"),"uncategorized"===e?a.props.set({media_folder_exclude:"all"}):e&&""!==e&&a.props.set({media_folder:parseInt(e,10)}),a.reset(),a.more({remove:!1}).then(()=>{t.removeClass("mm-loading")}).catch(()=>{t.removeClass("mm-loading")})}})),this.$el.addClass("mm-has-folder-sidebar")}}return this}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",d):d()})();